#include <ros/ros.h>
#include "sensor_msgs/LaserScan.h"

FILE* laserScanFileVar;

void myLaserScan0Handler (const sensor_msgs::LaserScan::ConstPtr& laserScan) {

  ROS_INFO ("Received a laser scan, first range point is [%f]",laserScan->ranges[0]);
  //fprintf (laserLogFile, "%f %f\n", laserScan->scan_time, currentTime());
  fprintf (laserScanFileVar, "%f \n", laserScan->scan_time);
}

int main(int argc, char** argv)

{
  ros::init(argc, argv, "receiveLaserScanStub"); //allows name remap thru command line
  ros::NodeHandle nh;

  char *dirRoot = getenv("CASC_DATA_ROOT");
  int STRING_LENGTH = 255; //this is MAX_PARAM_STRING_LEN in brad's code, in mowerParam.cxx

  char laserScanFileName[STRING_LENGTH];
  memset(laserScanFileName, 0, sizeof(char)*STRING_LENGTH);
  sprintf(laserScanFileName, "%s/playbackDump/laserScan0Log.txt", dirRoot);
  laserScanFileVar = fopen (laserScanFileName, "w");
  //laserScanFileVar = fopen ("receiveLaserLog.txt", "w");

  ros::Subscriber laserScanData0Subscriber =
    nh.subscribe<sensor_msgs::LaserScan> ("/laser0Scan", 1, myLaserScan0Handler);

  ros::spin();

}


/*
jlibby@ubuntu:~$ rostopic list -v

Published topics:
 * /applanixsim_test/laser0Scan [sensor_msgs/LaserScan] 1 publisher
 */
